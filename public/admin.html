<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'><path d='M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z'/></svg>">
    <title>Управление пользователями - УВДЗ</title>
    <link rel="stylesheet" href="/css/toast.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/judicial.css">
    <link rel="stylesheet" href="/css/admin.css">
</head>
<body>
    <div class="judicial-container">
        <!-- Animated background -->
        <div class="background-animation">
            <div class="bg-element element-1"></div>
            <div class="bg-element element-2"></div>
            <div class="bg-element element-3"></div>
        </div>

        <!-- Header -->
        <header class="judicial-header">
            <div class="header-content">
                <div class="logo-section">
                    <a href="/dashboard.html" class="back-button" title="Назад к дашборду" data-transition>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                    </a>
                    <h1>Управление пользователями</h1>
                </div>
                <div class="header-actions">
                    <div class="user-info">
                        <span id="userName">Администратор</span>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <button class="theme-toggle" id="themeToggle" title="Переключить тему">
                        <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="judicial-main">
            <!-- Page Header -->
            <div class="admin-header">
                <div class="header-left">
                    <h2>Пользователи системы</h2>
                    <p class="page-subtitle">Управление учетными записями и правами доступа</p>
                </div>
                <button class="btn btn-primary" id="addUserBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="8.5" cy="7" r="4"></circle>
                        <line x1="20" y1="8" x2="20" y2="14"></line>
                        <line x1="23" y1="11" x2="17" y2="11"></line>
                    </svg>
                    <span>Добавить пользователя</span>
                </button>
            </div>

            <!-- Search and Filter -->
            <div class="admin-controls">
                <div class="search-wrapper">
                    <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                    <input type="text" id="searchInput" placeholder="Поиск по имени пользователя или email...">
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all">
                        <span>Все</span>
                        <span class="badge" id="allCount">0</span>
                    </button>
                    <button class="filter-btn" data-filter="admin">
                        <span>Администраторы</span>
                        <span class="badge" id="adminCount">0</span>
                    </button>
                    <button class="filter-btn" data-filter="user">
                        <span>Пользователи</span>
                        <span class="badge" id="userCount">0</span>
                    </button>
                    <button class="filter-btn" data-filter="active">
                        <span>Активные</span>
                        <span class="badge success" id="activeCount">0</span>
                    </button>
                    <button class="filter-btn" data-filter="inactive">
                        <span>Неактивные</span>
                        <span class="badge error" id="inactiveCount">0</span>
                    </button>
                </div>
            </div>

            <!-- Users Table -->
            <div class="users-table-container">
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>Пользователь</th>
                            <th>Email</th>
                            <th>Роль</th>
                            <th>Статус</th>
                            <th>Последний вход</th>
                            <th>Дата создания</th>
                            <th>Действия</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <!-- Данные будут загружены через JS -->
                    </tbody>
                </table>
                <p id="noResults" class="no-results-message" style="display: none;">Пользователи не найдены.</p>
            </div>
        </main>

        <!-- Footer -->
        <footer class="judicial-footer">
            <p>© УВДЗ - Система управления базами данных.</p>
        </footer>
    </div>

    <!-- Modal: Add/Edit User -->
    <div id="userModal" class="modal-overlay" style="display: none;">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2 id="modalTitle">Добавить пользователя</h2>
                <button class="btn-icon close-button" id="closeModalBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <form id="userForm">
                    <div class="form-group">
                        <label for="username">Имя пользователя *</label>
                        <input type="text" id="username" required minlength="3" maxlength="50">
                    </div>

                    <div class="form-group">
                        <label for="email">Email *</label>
                        <input type="email" id="email" required>
                    </div>

                    <div class="form-group">
                        <label for="fullName">Полное имя</label>
                        <input type="text" id="fullName" maxlength="255">
                    </div>

                    <div class="form-group" id="passwordGroup">
                        <label for="password">Пароль *</label>
                        <div class="password-input-wrapper">
                            <input type="password" id="password" minlength="6">
                            <button type="button" class="toggle-password">
                                <svg class="eye-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                    <circle cx="12" cy="12" r="3"></circle>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="isAdmin">
                                <span class="checkbox-custom"></span>
                                <span>Администратор</span>
                            </label>
                        </div>

                        <div class="form-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="isActive" checked>
                                <span class="checkbox-custom"></span>
                                <span>Активный</span>
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelBtn">Отмена</button>
                <button class="btn btn-primary" id="saveUserBtn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    <span>Сохранить</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Delete Confirmation -->
    <div id="deleteModal" class="modal-overlay" style="display: none;">
        <div class="confirmation-dialog">
            <div class="confirmation-icon error">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="15" y1="9" x2="9" y2="15"></line>
                    <line x1="9" y1="9" x2="15" y2="15"></line>
                </svg>
            </div>
            <h3 class="confirmation-title">Удалить пользователя?</h3>
            <p class="confirmation-text">Это действие нельзя отменить. Все данные пользователя будут удалены.</p>
            <div class="confirmation-buttons">
                <button class="btn btn-secondary" id="cancelDeleteBtn">Отмена</button>
                <button class="btn btn-danger" id="confirmDeleteBtn">Удалить</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="/js/config.js"></script>
    <script src="/js/theme.js"></script>
    <script src="/js/transition.js"></script>
    <script src="/js/toast.js"></script>
    <script src="/js/admin.js"></script>
</body>
</html>